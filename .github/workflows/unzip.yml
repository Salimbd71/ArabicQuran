name: Unzip Quran to Root (Universal)

on:
  push:
    paths:
      - '**/*.zip'

jobs:
  unzip:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Extract everything from zip to root
        run: |
          find . -name "*.zip" -type f | while read zipfile; do
            echo "Extracting: $zipfile"
            unzip -o "$zipfile" -d .
            echo "Extracted directly to root"
          done

          echo "Current root contents after unzip:"
          ls -la

      - name: Delete all zip files
        run: find . -name "*.zip" -delete

      - name: Commit & Push
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions@users.noreply.github.com"
          git add .
          git status
          git commit -m "Unzipped all surah folders to root" || echo "Nothing new"
          git push || echo "Nothing to push"
